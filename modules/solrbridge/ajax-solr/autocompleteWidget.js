(function ($) {/** * A autocomplete widget for ajax-solr library. * This widget use the file autocomplete.js which is the autocomplete widget for jquery */AjaxSolr.AutocompleteWidget = AjaxSolr.AbstractWidget.extend({	/**	* The init function which bind the search box into jquery autocomplete widget	*/	init: function () {		var self = this;		self.requestSent = false;		options = { serviceUrl:'' };		self.autoc = $(self.target).find('#searchterm').autocomplete(options);	},	/**	* Display the loadding image during the ajax request	*/	beforeRequest: function () {	  $(this.target).find('#searchterm').addClass('ac_loading');	},	/**	* Process json result returned from Solr server	*/	afterRequest: function () {		var self = this;		//Incorrect keywords provided, and back request to Solr for misspelling suggestion		if(typeof AutoCompleteManager.response.spellcheck !== 'undefined' && typeof AutoCompleteManager.response.response.numFound !== 'undefined' && AutoCompleteManager.response.response.numFound < 1){		  if(typeof AutoCompleteManager.response.spellcheck.suggestions.collation !== 'undefined'){			AutoCompleteManager.store.addByValue('q', AutoCompleteManager.response.spellcheck.suggestions.collation);			AutoCompleteManager.store.addByValue('timestamp', new Date().getTime());			var arrs = AutoCompleteManager.response.spellcheck.suggestions.collation.split("autosuggest:");			self.autoc.didyoumeantext = arrs[1];			self.autoc.incorrectkeywords.push(self.autoc.q);			AutoCompleteManager.doRequest();		  }else{			self.autoc.processResponse(AutoCompleteManager.response);			$(this.target).find('#searchterm').removeClass('ac_loading');		  }		//Correct keywords provided, and display suggestion		}else{			self.autoc.processResponse(AutoCompleteManager.response);			$(this.target).find('#searchterm').removeClass('ac_loading');		}	}});})(jQuery);